{% extends 'adminpanel/base_admin.html' %}
{% block admin_content %}
<h4 class="mb-2">Users</h4>
<div class="card p-0">
  <table class="table table-dark table-striped mb-0">
    <thead>
      <tr>
        <th>Username</th>
        <th>Email</th>
        <th>Joined</th>
        <th>Admin</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for u in users %}
      <tr>
        <td>{{ u.username }}</td>
        <td>{{ u.email|default:'â€”' }}</td>
        <td>{{ u.date_joined|date:"Y-m-d H:i" }}</td>
        <td>{% if u.is_staff %}Yes{% else %}No{% endif %}</td>
        <td class="d-flex gap-1">
    

          <!-- Details user -->
          <a href="{% url 'adminpanel:edit_user' u.id %}" class="btn btn-sm btn-light border">Details</a>

          <!-- Delete user (only if not staff) -->
          {% if not u.is_staff %}
          <form method="post" action="{% url 'adminpanel:delete_user' u.id %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure you want to delete this user?');">Delete</button>
          </form>
          {% else %}
          <button class="btn btn-sm btn-secondary" disabled>Delete</button>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="6" class="text-muted">No users found.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
